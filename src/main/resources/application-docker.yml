server:
  port: 8081

spring:
  application:
    name: xx-rag
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/rag?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true&useSSL=false}
    username: ${SPRING_DATASOURCE_USERNAME:root}
    password: ${SPRING_DATASOURCE_PASSWORD:root}
    driver-class-name: com.mysql.cj.jdbc.Driver
  elasticsearch:
    uris: ${SPRING_ELASTICSEARCH_URIS:localhost:9200}
    username: ${SPRING_ELASTICSEARCH_USERNAME:elastic}
    password: ${SPRING_ELASTICSEARCH_PASSWORD:}

deepseek:
  api-key: ${DEEPSEEK_API_KEY:}
  base-url: ${DEEPSEEK_BASE_URL:https://api.deepseek.com/v1}
  model: ${DEEPSEEK_MODEL:deepseek-chat}
  temperature: ${DEEPSEEK_TEMPERATURE:0.7}
  max-tokens: ${DEEPSEEK_MAX_TOKENS:2048}
  timeout-seconds: ${DEEPSEEK_TIMEOUT_SECONDS:120}

rag:
  prompt:
    system-prompt: |
      你是潇潇知识问答助手，需遵守：
      1. 仅用简体中文作答。
      2. 回答需先给结论，再给论据。
      3. 若无足够信息，请回答"暂无相关信息"并说明原因。
      4. 回复自然、流畅，不要提及"文档"或"检索"等技术术语。

embedding:
  api:
    model: ${EMBEDDING_MODEL:text-embedding-v4}
    dimension: ${EMBEDDING_DIMENSION:1024}
    api-key: ${EMBEDDING_API_KEY:"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}

app:
  rag:
    retrieval:
      hybrid-enabled: ${RETRIEVAL_HYBRID_ENABLED:true}
      recall-top-k: ${RETRIEVAL_RECALL_TOP_K:5}
      candidate-multiplier: ${RETRIEVAL_CANDIDATE_MULTIPLIER:10}
      rrf:
        k: ${RRF_K:60}
        text-weight: ${RRF_TEXT_WEIGHT:1.0}
        vector-weight: ${RRF_VECTOR_WEIGHT:1.0}
        final-top-k: ${RRF_FINAL_TOP_K:10}
  text-chunker:
    chunk-size: ${CHUNK_SIZE:512}
    overlap: ${CHUNK_OVERLAP:100}

mybatis:
  mapper-locations: classpath:mapper/*.xml
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl

logging:
  level:
    yuuine.xxapp: debug
    yuuine.raginference: debug
    org.springframework.web.reactive: debug
  file:
    name: ./logs/application.log
  logback:
    rollingpolicy:
      max-file-size: 10MB
      max-history: 7
      total-size-cap: 1GB
      file-name-pattern: ./logs/application.%d{yyyy-MM-dd}.%i.log